* refactor codes with metaprogramming and regex
